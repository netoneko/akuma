[package]
name = "akuma"
version = "0.1.0"
edition = "2024"

[[bin]]
name = "akuma"
bench = false
test = false

[profile.dev]
panic = "abort"

[profile.release]
panic = "abort"

[dependencies]
talc = "4"
spinning_top = "0.3"
# hashbrown without ahash (ahash requires CPU crypto extensions)
hashbrown = { version = "0.14", default-features = false, features = ["allocator-api2"] }
once_cell = { version = "1", default-features = false, features = ["alloc", "race"] }
fdt = "0.1"
smoltcp = { version = "0.11", default-features = false, features = ["log", "async", "proto-ipv4", "socket-tcp", "socket-udp", "medium-ethernet"] }
virtio-drivers = { version = "0.7", default-features = false }
arm_pl031 = "0.2"

# SSH crypto dependencies (no_std compatible)
sha2 = { version = "0.10", default-features = false }
hmac = { version = "0.12", default-features = false }
aes = { version = "0.8", default-features = false }
ctr = { version = "0.9", default-features = false }
curve25519-dalek = { version = "4", default-features = false, features = ["alloc", "zeroize"] }
x25519-dalek = { version = "2", default-features = false, features = ["static_secrets"] }
ed25519-dalek = { version = "2", default-features = false, features = ["alloc", "zeroize"] }
rand_core = { version = "0.6", default-features = false }

# Embassy async runtime (for bare metal aarch64)
embassy-executor = { version = "0.7", default-features = false, features = ["nightly", "arch-spin"] }
embassy-time = { version = "0.4", default-features = false, features = ["generic-queue-8"] }
embassy-time-driver = { version = "0.2", default-features = false }
embassy-net = { version = "0.6", default-features = false, features = ["proto-ipv4", "tcp", "medium-ethernet", "dhcpv4", "dns"] }
embassy-net-driver = { version = "0.2", default-features = false }
embassy-sync = { version = "0.6", default-features = false }
critical-section = { version = "1.2", default-features = false }
static_cell = { version = "2.1" }

# ext2 filesystem is implemented directly in src/vfs/ext2.rs
# No external crate - custom implementation for better no_std compatibility

# HTTP client/server (no_std)
edge-http = { version = "0.6", default-features = false, features = ["io"] }
embedded-io-async = { version = "0.6", default-features = false }

# Interactive terminal for shell (no_std)
nostd-interactive-terminal = { version = "0.1", default-features = false, features = ["ansi-support"] }

# Rhai scripting engine (no_std)
rhai = { version = "1.19", default-features = false, features = ["no_std", "sync"] }

# ELF parser (no_std)
elf = { version = "0.7", default-features = false }

# TLS support (no_std compatible)
# Using fork with exposed handshake/extensions modules for custom TlsVerifier
embedded-tls = { version = "0.17", default-features = false, features = ["alloc"] }

# X.509 certificate parsing (no_std compatible)
x509-cert = { version = "0.2", default-features = false }
der = { version = "0.7", default-features = false, features = ["alloc", "oid"] }
const-oid = { version = "0.9", default-features = false }

# ECDSA P-256 signature verification
p256 = { version = "0.13", default-features = false, features = ["ecdsa"] }

# RSA signature verification
rsa = { version = "0.9", default-features = false, features = ["sha2"] }

[patch.crates-io]
# Fork based on v0.17.0 (commit 1eaaa136) with exposed handshake/extensions modules
# After creating the branch, replace with your actual commit hash
embedded-tls = { git = "https://github.com/netoneko/embedded-tls", branch = "expose-verifier-types" }
